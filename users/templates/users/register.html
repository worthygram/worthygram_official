{% extends 'blog/base.html' %}
{% load widget_tweaks %}
{% block head %}
<title>Register to see worthy posts</title>
{% endblock head %}

{% block content %}
<style>
    .form{
        margin-top: 10px;
        text-align: center;
        display: flex;
        width: 100%;
    }
</style>
<div id="overlay">
    <div class="cv-spinner">
      <span class="spinner"></span>
    </div>
  </div>

<div style="margin-top: 150px;">
    
    <form method="POST"  >
        {% csrf_token %}

        <div style="text-align: center;" >
            <h2 style="font-size: 20px; font-weight: bolder; color: #4520d8;">Turn your REEL ðŸ“º Happiness to REAL ðŸ˜‡ Happiness,try Worthygram</h2>

            <div style="margin-top: 30px; color: #4520d8;">
                <label >{{ form.username.label_tag }}</label>
            {{ form.username.errors }}
            {% render_field form.username class="form" hx-post="/validate_username/" hx-swap="outerhtml" hx-trigger="keyup changed" hx-target="#username-error" %}
            <div id="username-error"></div>

            <label>{{ form.email.label_tag }}</label>
            {{ form.email.errors }}
            {% render_field form.email class="form" hx-post="/validate_email/" hx-swap="outerhtml" hx-trigger="keyup changed" hx-target="#email-error" %}
            <div id="email-error"></div>

            <label>{{ form.password1.label_tag }}</label>
            {{ form.password1.errors }}
            {% render_field form.password1 class="form" %}

            <label>{{ form.password2.label_tag }}</label>
            {{ form.password2.errors }}
            {% render_field form.password2 class="form" %}
            </div>
        </div>
        
        <div style="text-align: center;">
            <button type="submit" style="width: 30%;
        align-items: center;
        margin-top: 10px;
        padding-top: 15px;
        padding-bottom: 12px;
        border-radius: 40px;
        background-color: #007da1;
        color: #fff;
        border: none;
        font-size: 20px;
        font-weight: 600;" id="register">Register</button>
        </div>
    </form>

    <div style="margin-top: 10px; text-align: center; font-size: 20px;">
        <small >
                <b>Already Have An Account? </b>
                <a style="font-weight: bold;"  href="{% url 'login' %}">Log In</a>
        </small>
    </div>
</div>
</div>
{% endblock content %}


{% block script %}

<script>
    jQuery(function($){
$(document).ajaxSend(function() {
 $("#overlay").fadeIn(300);
});
 
$('#register').click(function(){
 $.ajax({
   type: 'GET',
   success: function(data){
     console.log(data);
   }
 }).done(function() {
   setTimeout(function(){
     $("#overlay").fadeOut(300);
   },500);
 });
}); 
});
</script>

<script src="https://unpkg.com/htmx.org@1.6.0"></script>
<script>
  document.body.addEventListener('htmx:configRequest', (event) => {
    event.detail.headers['X-CSRFToken'] = '{{ csrf_token }}';
  })
</script>
{% endblock script %}